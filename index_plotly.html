<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Goodreads Book Insights: Ratings, Reviews, and Pages</title>

    <!-- Google Fonts: Merriweather for headings, Roboto for body -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

    <!-- Plotly.js CDN -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

    <style>
        /* Basic Reset and Defaults */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            background-color: #f8f9fa; /* Light off-white/soft gray */
            color: #333;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        header {
            background-color: #2c3e50; /* Muted blue/charcoal */
            color: #ecf0f1; /* Light text for header */
            padding: 1.5rem 1rem;
            text-align: center;
            border-bottom: 3px solid #bdc3c7; /* Accent border */
        }

        header h1 {
            font-family: 'Merriweather', serif;
            font-weight: 700;
            font-size: 2.2rem;
            margin-bottom: 0.25rem;
        }
         header p {
            font-size: 1rem;
            color: #e0e0e0;
        }


        main {
            flex-grow: 1;
            width: 100%;
            max-width: 1200px; /* Max container width */
            margin: 0 auto;
            padding: 20px;
        }

        .chart-section {
            background-color: #ffffff; /* White background for chart sections */
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .chart-section h2 {
            font-family: 'Merriweather', serif;
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: #34495e; /* Darker muted blue */
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
        }

        .chart-container {
            width: 100%;
            min-height: 450px; /* Minimum height for plots */
        }

        /* Loading Spinner Styles */
        .loading-spinner-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.3s ease-in-out;
        }

        .spinner {
            border: 8px solid #f3f3f3; /* Light grey */
            border-top: 8px solid #8662C6; /* Muted Purple */
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
        }

        .hidden {
            opacity: 0;
            pointer-events: none;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        footer {
            background-color: #2c3e50; /* Muted blue/charcoal */
            color: #ecf0f1;
            text-align: center;
            padding: 1rem;
            margin-top: auto; /* Pushes footer to bottom */
            font-size: 0.9rem;
        }
        footer a {
            color: #a7d7f9; /* Lighter blue for links in footer */
            text-decoration: none;
        }
        footer a:hover {
            text-decoration: underline;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8rem;
            }
            .chart-section h2 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="loading-spinner-overlay" id="loadingOverlay">
        <div class="spinner"></div>
    </div>

    <header>
        <h1>Goodreads Book Insights</h1>
        <p>Exploring Relationships in Book Data: Ratings, Reviews, and Page Counts</p>
    </header>

    <main>
        <section class="chart-section" id="plot1-section">
            <h2>Reviews vs. Total Ratings</h2>
            <div id="plot1Container" class="chart-container">
                <!-- Plotly chart 1 will be rendered here -->
            </div>
        </section>

        <section class="chart-section" id="plot2-section">
            <h2>Page Count vs. Average Rating</h2>
            <div id="plot2Container" class="chart-container">
                <!-- Plotly chart 2 will be rendered here -->
            </div>
        </section>
    </main>

    <footer>
        <p>Data Visualization by Jules (AI Agent). Data from <a href="https://www.kaggle.com/datasets/bahramjannesarr/goodreads-book-datasets-100k" target="_blank" rel="noopener noreferrer">Goodreads 100k Books Dataset on Kaggle</a>.
        Powered by <a href="https://plotly.com/javascript/" target="_blank" rel="noopener noreferrer">Plotly.js</a>.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const loadingOverlay = document.getElementById('loadingOverlay');
            const plot1Container = document.getElementById('plot1Container');
            const plot2Container = document.getElementById('plot2Container');

            // Show spinner (it's visible by default, this is just for logical flow)
            loadingOverlay.classList.remove('hidden');

            async function fetchDataAndCreatePlots() {
                try {
                    const response = await fetch('goodreads_plotly_data.json');
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const data = await response.json();
                    console.log("Data loaded successfully:", data.length, "records");

                    // Hide spinner
                    loadingOverlay.classList.add('hidden');

                    if (data && data.length > 0) {
                        createPlot1(data);
                        createPlot2(data);
                    } else {
                        plot1Container.innerHTML = "<p>No data available to display plots.</p>";
                        plot2Container.innerHTML = "<p>No data available to display plots.</p>";
                    }

                } catch (error) {
                    console.error("Failed to load or process data:", error);
                    loadingOverlay.classList.add('hidden'); // Hide spinner on error too
                    plot1Container.innerHTML = `<p>Error loading data: ${error.message}. Please try again later.</p>`;
                    plot2Container.innerHTML = `<p>Error loading data: ${error.message}. Please try again later.</p>`;
                }
            }

            function createPlot1(data) {
                const trace1 = {
                    x: data.map(d => d.reviews),
                    y: data.map(d => d.totalratings),
                    mode: 'markers',
                    type: 'scatter',
                    text: data.map(d => `Title: ${d.title}<br>Author: ${d.author}<br>Avg Rating: ${d.rating.toFixed(2)}<br>Pages: ${d.pages}`),
                    hovertemplate: `<b>%{text}</b><br>Reviews: %{x:,}<br>Total Ratings: %{y:,}<extra></extra>`,
                    marker: {
                        color: '#5DADE2', // Muted Blue
                        opacity: 0.6,
                        size: 7,
                        symbol: 'circle',
                        line: {
                            width: 0.5,
                            color: '#34495E' // Darker Muted Blue for marker border
                        }
                    }
                };

                const layout1 = {
                    title: {
                        text: 'Impact of Review Volume on Overall Rating Count',
                        font: { family: 'Merriweather, serif', size: 18, color: '#34495E' }
                    },
                    xaxis: {
                        title: 'Number of Text Reviews',
                        titlefont: { family: 'Roboto, sans-serif', size: 14, color: '#555' },
                        gridcolor: '#e9e9e9',
                        zerolinecolor: '#d9d9d9'
                    },
                    yaxis: {
                        title: 'Total Number of Ratings Received',
                        titlefont: { family: 'Roboto, sans-serif', size: 14, color: '#555' },
                        gridcolor: '#e9e9e9',
                        zerolinecolor: '#d9d9d9'
                    },
                    hovermode: 'closest',
                    plot_bgcolor: '#fdfdfd', // Slightly off-white for plot area
                    paper_bgcolor: '#ffffff', // White for paper background (chart section bg)
                    margin: { l: 70, r: 30, b: 60, t: 70, pad: 4 }, // Adjusted margins
                    font: { family: 'Roboto, sans-serif', color: '#333' } // Default font for the plot
                };

                const config = { responsive: true, displaylogo: false };
                Plotly.newPlot(plot1Container, [trace1], layout1, config);
            }

            function createPlot2(data) {
                const trace2 = {
                    x: data.map(d => d.pages),
                    y: data.map(d => d.rating), // This is average_rating
                    mode: 'markers',
                    type: 'scatter',
                    text: data.map(d => `Title: ${d.title}<br>Author: ${d.author}<br>Reviews: ${d.reviews.toLocaleString()}<br>Total Ratings: ${d.totalratings.toLocaleString()}`),
                    hovertemplate: `<b>%{text}</b><br>Pages: %{x:,}<br>Avg Rating: %{y:.2f}<extra></extra>`,
                    marker: {
                        color: '#82E0AA', // Muted Green
                        opacity: 0.6,
                        size: 7,
                        symbol: 'circle',
                        line: {
                            width: 0.5,
                            color: '#28B463' // Darker Muted Green
                        }
                    }
                };

                const layout2 = {
                    title: {
                        text: 'Influence of Page Count on Average Book Rating',
                        font: { family: 'Merriweather, serif', size: 18, color: '#34495E' }
                    },
                    xaxis: {
                        title: 'Number of Pages',
                        titlefont: { family: 'Roboto, sans-serif', size: 14, color: '#555' },
                        gridcolor: '#e9e9e9',
                        zerolinecolor: '#d9d9d9'
                    },
                    yaxis: {
                        title: 'Average Rating (out of 5)',
                        titlefont: { family: 'Roboto, sans-serif', size: 14, color: '#555' },
                        gridcolor: '#e9e9e9',
                        zerolinecolor: '#d9d9d9'
                    },
                    hovermode: 'closest',
                    plot_bgcolor: '#fdfdfd',
                    paper_bgcolor: '#ffffff',
                    margin: { l: 70, r: 30, b: 60, t: 70, pad: 4 },
                    font: { family: 'Roboto, sans-serif', color: '#333' }
                };

                const config = { responsive: true, displaylogo: false };
                Plotly.newPlot(plot2Container, [trace2], layout2, config);
            }

            fetchDataAndCreatePlots();
        });
    </script>
</body>
</html>
